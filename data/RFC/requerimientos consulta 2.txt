-- Métodos CONSULTA.

--RFC1
--MOSTRAR EL DINERO RECOLECTADO POR VENTAS EN CADA SUCURSAL DURANTE UN PERIODO 
  DE TIEMPO Y EN EL AÑO CORRIDO
 
SELECT SUM(VALORTOTAL) AS VALORTOTAL 
FROM( SELECT VALORTOTAL, FECHA, IDSUCURSAL
      FROM FACTURA
      WHERE EXTRACT(YEAR FROM FECHA) = EXTRACT(YEAR FROM (SELECT SYSDATE FROM DUAL))
      AND FECHA BETWEEN 'DD/MM/YY' AND 'DD/MM/YY' AND IDSUCURSAL = ?);

--RFC2
--Encuentra las 20 promciones mas populares.
	
SELECT * FROM (SELECT RELACION , ID
FROM ( SELECT  TRUNC((SELECT SYSDATE FROM DUAL)   - FECHAINICIAL)  AS RELACION, ID
FROM prom_descuento)
GROUP BY RELACION , ID
ORDER BY RELACION DESC)
WHERE rownum between 1 and 20 ; 

--RFC3
--MOSTRAR EL ÍNDICE DE OCUPACIÓN DE CADA UNA DE BODEGAS Y ESTANTES DE UNA SUCURSA

SELECT IDESTANTE,SUM(INDICEPESO1) AS INDICEPESO,SUM(INDICEVOL1) INDICEVOL,IDSUCURSAL
FROM(
 SELECT IDESTANTE,PESOTOTAL/CAPACIDADPESO AS INDICEPESO1 ,VOLUMENTOTAL/CAPACIDADVOL AS INDICEVOL1,IDSUCURSAL
FROM(SELECT A.IDESTANTE AS ESTANTE, A.CANTIDAD, A.CODIGOBARRASPRODUCTO, (a.cantidad*B.PESO) AS PESOTOTAL, (A.CANTIDAD*B.VOLUMEN ) AS VOLUMENTOTAL
FROM PRODUCTOSENESTANTE A JOIN(SELECT CODIGOBARRAS, PESO, VOLUMEN 
                            FROM PRODUCTO)B ON  A.CODIGOBARRASPRODUCTO = b.codigobarras ) K 
                            JOIN (SELECT CAPACIDADVOL, CAPACIDADPESO, IDSUCURSAL,ID AS IDESTANTE
                                  FROM ESTANTE) L ON k.ESTANTE= l.idestante)
                                  GROUP BY IDESTANTE, IDSUCURSAL;
SELECT IDBODEGA,SUM(INDICEPESO1) AS INDICEPESO,SUM(INDICEVOL1) INDICEVOL,IDSUCURSAL
FROM(
 SELECT IDBODEGA,PESOTOTAL/CAPACIDADPESO AS INDICEPESO1 ,VOLUMENTOTAL/CAPACIDADVOL AS INDICEVOL1,IDSUCURSAL
FROM(SELECT A.IDBODEGA AS BODEGA, A.CANTIDAD, A.CODIGOBARRASPRODUCTO, (a.cantidad*B.PESO) AS PESOTOTAL, (A.CANTIDAD*B.VOLUMEN ) AS VOLUMENTOTAL
FROM PRODUCTOSENBODEGA A JOIN(SELECT CODIGOBARRAS, PESO, VOLUMEN 
                            FROM PRODUCTO)B ON  A.CODIGOBARRASPRODUCTO = b.codigobarras ) K 
                            JOIN (SELECT CAPACIDADVOL, CAPACIDADPESO, IDSUCURSAL,ID AS IDBODEGA
                                  FROM BODEGA) L ON k.BODEGA= l.idBODEGA)
                                  GROUP BY IDBODEGA, IDSUCURSAL;
--RFC4
--muestra los productos q cumplen cierta caracterstica.

--con un precio en un rango dado.
SELECT *
FROM PRODUCTOS
WHERE PRECIO BETWEEN ? AND ?;

--productos ofrecidos por un proveedor.
SELECT *
FROM PROVEEDORES_PRODUCTO
WHERE PROVEEDOR = '?';

--productos con fecha de vencimiento despues de cierta fecha.
SELECT *
FROM PRODUCTO
WHERE FECHAVENCIMIENTO> ?;

--productos con un peso en un rango dado.
SELECT *
FROM PRODUCTO
WHERE PRECIOUNITARIO BETWEEN ? AND ?;

--productos con un volumen en un rango dado.
SELECT *
FROM PRODUCTO
WHERE VOLUMEN BETWEEN ? AND ?;

--productos con un tipo dado.
SELECT *
FROM PRODUCTO
WHERE TIPO = ?;

--productos con una categoria dada.
SELECT *
FROM PRODUCTO
WHERE CATEGORIA = ?;

--productos ofrecidos por cierta sucursal.
SELECT *
FROM SUCURSAL_PRODUCTO
WHERE PRODUCTO= ?;

--productos ofrecidos en cierta ciudad.
SELECT ID, CIUDAD, CODIGOPRODUCTO
FROM (SELECT ID, CIUDAD
      FROM SUCURSAL
      WHERE CIUDAD=?)A JOIN (SELECT *
                             FROM SUCURSAL_PRODUCTO) B ON A.ID= B.IDSUCURSAL;

--RFC5
-- -  MOSTRAR LAS COMPRAS HECHAS POR SUPERANDES A LOS PROVEEDORES
SELECT *
FROM ORDENPEDIDO
WHERE ESTADO = 'Entregado'
ORDER BY PROVEEDOR;

--RFC6
-- MOSTRAR LAS VENTAS DE SUPERANDES A UN USUARIO DADO, EN UN RANGO DE FECHAS INDICADO.

SELECT *
FROM factura
WHERE FECHA BETWEEN 'DD/MM/AA' AND 'DD/MM/AA' AND CLIENTE = ;

--RFC8
-- ENCONTRAR LOS CLIENTES FRECUENTES 

SELECT  MESES , COUNT(ID_FACTURA), CLIENTE
FROM(SELECT FECHA , EXTRACT(MONTH FROM FECHA) AS MESES , NUMERO AS ID_FACTURA , CLIENTE
FROM FACTURA)
GROUP BY MESES, CLIENTE, ID_FACTURA
HAVING COUNT (ID_FACTURA) >=2;























