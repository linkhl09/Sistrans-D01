--RFC3
--MOSTRAR EL ÍNDICE DE OCUPACIÓN DE CADA UNA DE BODEGAS Y ESTANTES DE UNA SUCURSA

SELECT IDESTANTE,SUM(INDICEPESO1) AS INDICEPESO,SUM(INDICEVOL1) INDICEVOL,IDSUCURSAL
FROM(
 SELECT IDESTANTE,PESOTOTAL/CAPACIDADPESO AS INDICEPESO1 ,VOLUMENTOTAL/CAPACIDADVOL AS INDICEVOL1,IDSUCURSAL
FROM(SELECT A.IDESTANTE AS ESTANTE, A.CANTIDAD, A.CODIGOBARRASPRODUCTO, (a.cantidad*B.PESO) AS PESOTOTAL, (A.CANTIDAD*B.VOLUMEN ) AS VOLUMENTOTAL
FROM PRODUCTOSENESTANTE A JOIN(SELECT CODIGOBARRAS, PESO, VOLUMEN 
                            FROM PRODUCTO)B ON  A.CODIGOBARRASPRODUCTO = b.codigobarras ) K 
                            JOIN (SELECT CAPACIDADVOL, CAPACIDADPESO, IDSUCURSAL,ID AS IDESTANTE
                                  FROM ESTANTE) L ON k.ESTANTE= l.idestante)
                                  GROUP BY IDESTANTE, IDSUCURSAL;
SELECT IDBODEGA,SUM(INDICEPESO1) AS INDICEPESO,SUM(INDICEVOL1) INDICEVOL,IDSUCURSAL
FROM(
 SELECT IDBODEGA,PESOTOTAL/CAPACIDADPESO AS INDICEPESO1 ,VOLUMENTOTAL/CAPACIDADVOL AS INDICEVOL1,IDSUCURSAL
FROM(SELECT A.IDBODEGA AS BODEGA, A.CANTIDAD, A.CODIGOBARRASPRODUCTO, (a.cantidad*B.PESO) AS PESOTOTAL, (A.CANTIDAD*B.VOLUMEN ) AS VOLUMENTOTAL
FROM PRODUCTOSENBODEGA A JOIN(SELECT CODIGOBARRAS, PESO, VOLUMEN 
                            FROM PRODUCTO)B ON  A.CODIGOBARRASPRODUCTO = b.codigobarras ) K 
                            JOIN (SELECT CAPACIDADVOL, CAPACIDADPESO, IDSUCURSAL,ID AS IDBODEGA
                                  FROM BODEGA) L ON k.BODEGA= l.idBODEGA)
                                  GROUP BY IDBODEGA, IDSUCURSAL;